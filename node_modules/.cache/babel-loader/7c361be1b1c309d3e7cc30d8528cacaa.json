{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/joseph/Documents/CodingProjects/Loma V2/lomav2/src/App.js\";\nimport React from 'react'; //import './App.css';\n\nimport { SearchBar } from './Components/SearchBar';\nimport { Results } from './Components/Results';\nimport { Landing } from './Components/Landing';\nimport { LoadingPop } from './Components/LoadingPop'; //import { Data } from '../src/util/Data';\n\nimport fetch from 'node-fetch';\nimport imagePlaceholder from './assets/gallery.png'; //import loading from './assets/loading.gif';\n\nimport { hotjar } from 'react-hotjar';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      Data: [],\n      AccessToken: \"none\",\n      ExpiryDate: 0,\n      resultsDisplay: \"âš¡ï¸ Trending âš¡ï¸\",\n      searchTerm: \"\",\n      loading: false,\n      landing: true,\n      depopData: {\n        data: [{\n          nothing: \"none\"\n        }],\n        status: 'unresolved'\n      },\n      gumtreeData: {\n        data: [{\n          nothing: \"none\"\n        }],\n        status: 'unresolved'\n      }\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.setData = this.setData.bind(this);\n    this.toggleDisplay = this.toggleDisplay.bind(this);\n    this.reOrderDisplay = this.reOrderDisplay.bind(this);\n  }\n\n  componentDidMount() {\n    const getEbayAccessToken = () => {\n      if (new Date().getTime() > this.state.ExpiryDate) {\n        console.log(\"this app does not have an access token\");\n        console.log(\"getting access token\");\n        var myHeaders = new Headers();\n        myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n        myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n        myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n        var urlencoded = new URLSearchParams();\n        urlencoded.append(\"grant_type\", \"client_credentials\");\n        urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n        var requestOptions = {\n          method: 'POST',\n          headers: myHeaders,\n          body: urlencoded,\n          redirect: 'follow'\n        };\n        fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions).then(response => response.json()).then(jsonresponse => {\n          this.setState({\n            AccessToken: jsonresponse.access_token,\n            ExpiryDate: new Date().getTime() + jsonresponse.expires_in\n          });\n        }).catch(error => console.log('error', error));\n      }\n    }; //DATA CLEANERS\n\n\n    const isNull = property => {\n      if (property === null || property === undefined) {\n        return \" \";\n      } else {\n        return property;\n      }\n    };\n\n    const isPriceNull = price => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1);\n      }\n    };\n\n    const missingImagesFiltered = imageProp => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    }; //\n\n\n    const getDepopData = async () => {\n      console.log(\"getting depop data\");\n      const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n      const depopResponse = await fetch(depop_url);\n      const depopData = await depopResponse.json();\n      const depopDataFiltered = depopData.filter(listing => {\n        if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n          return true;\n        } else {\n          return false;\n        }\n      });\n      const depopDataParsed = depopDataFiltered.map(listing => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        };\n      });\n      this.setState({\n        depopData: {\n          data: depopDataParsed,\n          status: 'resolved'\n        }\n      });\n    }; ///\n\n\n    const getGumtreeData = async () => {\n      console.log(\"getting depop data\");\n      const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\";\n      const gumtreeResponse = await fetch(gumtree_url);\n      const gumtreeData = await gumtreeResponse.json();\n      const gumtreeDataFiltered = gumtreeData.filter(listing => listing.title.toLowerCase().includes(this.state.searchTerm) || listing.description.toLowerCase().includes(this.state.searchTerm));\n      const gumtreeDataParsed = gumtreeDataFiltered.map(listing => {\n        return {\n          title: listing.title,\n          price: listing.price.substring(1),\n          description: listing.description,\n          image: missingImagesFiltered(listing.image),\n          url: listing.url,\n          site: \"gumtree\"\n        };\n      });\n      this.setState({\n        gumtreeData: {\n          data: gumtreeDataParsed,\n          status: 'resolved'\n        }\n      });\n    }; ///////\n\n\n    getEbayAccessToken();\n    getDepopData();\n    getGumtreeData();\n    hotjar.initialize(2123002, 6);\n    console.log(\"access token\" + this.state.AccessToken);\n    console.log(\"depop data\" + this.state.depopData.data);\n  } //COMPONENT MOUNT ENDS\n\n\n  toggleLanding() {\n    this.setState({\n      landing: true\n    });\n  }\n\n  async toggleDisplay(sortOrder) {\n    await this.setState({\n      resultsDisplay: sortOrder\n    });\n    console.log(sortOrder);\n    console.log(\"the display mode is now\" + this.state.resultsDisplay);\n    this.reOrderDisplay();\n  }\n\n  reOrderDisplay() {\n    /// functions\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        var temp = array[i];\n        array[i] = array[j];\n        array[j] = temp;\n      }\n\n      return array;\n    }\n\n    function highest(a, b) {\n      if (Number(a.price) < Number(b.price)) {\n        return 1;\n      }\n\n      if (Number(a.price) > Number(b.price)) {\n        return -1;\n      }\n\n      return 0;\n    }\n\n    function lowest(a, b) {\n      if (Number(a.price) < Number(b.price)) {\n        return -1;\n      }\n\n      if (Number(a.price) > Number(b.price)) {\n        return 1;\n      }\n\n      return 0;\n    }\n\n    if (this.state.Data) {\n      if (this.state.resultsDisplay === \"âš¡ï¸ Trending âš¡ï¸\") {\n        this.setState({\n          Data: shuffleArray(this.state.Data)\n        });\n      } else if (this.state.resultsDisplay === \"Highest price first â–²\") {\n        this.setState({\n          Data: this.state.Data.sort(highest)\n        });\n      } else if (this.state.resultsDisplay === \"Lowest price first â–¼\") {\n        this.setState({\n          Data: this.state.Data.sort(lowest)\n        });\n      } else {\n        this.setState({});\n      }\n    }\n  }\n\n  async setData(searchQuery) {\n    if (!searchQuery) {\n      alert(\"Tell me what to search! ðŸ˜\");\n      return;\n    }\n\n    this.setState({\n      searchTerm: searchQuery.toLowerCase(),\n      loading: true,\n      landing: false\n    });\n\n    if (new Date().getTime() > this.state.ExpiryDate) {\n      console.log(\"this app does not have an access token\");\n      console.log(\"getting access token\");\n      var myHeaders = new Headers();\n      myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n      myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n      myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n      var urlencoded = new URLSearchParams();\n      urlencoded.append(\"grant_type\", \"client_credentials\");\n      urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n      var requestOptions = {\n        method: 'POST',\n        headers: myHeaders,\n        body: urlencoded,\n        redirect: 'follow'\n      };\n      fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions).then(response => response.json()).then(jsonresponse => {\n        this.setState({\n          AccessToken: jsonresponse.access_token,\n          ExpiryDate: new Date().getTime() + jsonresponse.expires_in\n        });\n      }).catch(error => console.log('error', error));\n    } else {\n      console.log(\"this has an access token\" + this.state.AccessToken + this.state.depopData.data);\n    } // console.log(\"access token\" + this.state.AccessToken);\n    // let formattedExpiryDate = this.state.ExpiryDate * 1000;\n    //console.log(formattedExpiryDate.toUTCString())\n    /////////////////////DATA CLEANERS///////////////////////////\n\n\n    const isNull = property => {\n      if (property === null || property === undefined) {\n        return \" \";\n      } else {\n        return property;\n      }\n    }; //  const isAnyPropEmpty = (listing) => {\n    //    if (listing) {\n    //      return listing;\n    //    } else {\n    //      return {\n    //      }\n    //    } \n    //  };\n\n\n    const isPriceNull = price => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1);\n      }\n    };\n\n    const ebayPriceParsed = listing => {\n      if (listing.price.currency === \"USD\") {\n        return listing.price.convertedFromValue ? listing.price.convertedFromValue : listing.price.value;\n      } else {\n        return listing.price.value;\n      }\n    };\n\n    const facebookPriceParsed = price => {\n      let rawPrice = price.substring(1);\n\n      if (!price || price === \"FREE\") {\n        return \"0\";\n      } else if (price === \"See listings near me\") {\n        return \"~\";\n      } else if (!rawPrice.includes(\"Â£\")) {\n        return rawPrice;\n      } else if (rawPrice.includes(\"Â£\")) {\n        return rawPrice.substring(0, rawPrice.indexOf(\"Â£\"));\n      }\n    };\n\n    const missingImagesFiltered = imageProp => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    };\n\n    const tnmissingImagesFiltered = listing => {\n      if (!listing.photos) {\n        return imagePlaceholder;\n      } else {\n        return listing.photos[0].url;\n      }\n    };\n\n    const eBayMissingImagesFiltered = listing => {\n      if (!listing.hasOwnProperty(\"image\") || !listing.image.hasOwnProperty(\"imageUrl\")) {\n        return imagePlaceholder;\n      } else {\n        return listing.image.imageUrl;\n      }\n    }; ////////////////////////////////////////////////////////////\n\n\n    const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n    const depopResponse = await fetch(depop_url);\n    const depopData = await depopResponse.json();\n    const depopDataFiltered = depopData.filter(listing => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else {\n        return false;\n      }\n    }); // || isNull(listing.description).includes(this.state.searchTerm));\n\n    const depopDataParsed = depopDataFiltered.map(listing => {\n      return {\n        title: isNull(listing.title),\n        price: isPriceNull(listing.price),\n        description: isNull(listing.description),\n        image: isNull(missingImagesFiltered(listing.image)),\n        url: isNull(listing.url),\n        site: \"depop\"\n      };\n    });\n    const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\";\n    const gumtreeResponse = await fetch(gumtree_url);\n    const gumtreeData = await gumtreeResponse.json();\n    const gumtreeDataFiltered = gumtreeData.filter(listing => listing.title.toLowerCase().includes(this.state.searchTerm) || listing.description.toLowerCase().includes(this.state.searchTerm));\n    const gumtreeDataParsed = gumtreeDataFiltered.map(listing => {\n      return {\n        title: listing.title,\n        price: listing.price.substring(1),\n        description: listing.description,\n        image: missingImagesFiltered(listing.image),\n        url: listing.url,\n        site: \"gumtree\"\n      };\n    });\n    const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\";\n    const facebookResponse = await fetch(facebook_url);\n    const facebookData = await facebookResponse.json();\n    const facebookDataFiltered = facebookData.filter(listing => listing.title.toLowerCase().includes(searchQuery || listing.description.toLowerCase().includes(searchQuery)));\n    const facebookDataParsed = facebookDataFiltered.map(listing => {\n      return {\n        title: \"\" + isNull(listing.title),\n        price: \"\" + facebookPriceParsed(listing.price),\n        description: \"\" + isNull(listing.description),\n        image: \"\" + missingImagesFiltered(listing.image),\n        url: \"\" + isNull(listing.url),\n        site: \"facebook\"\n      };\n    }); ////////facebook\n\n    const etsyRaw = await fetch(`https://loma-cors.herokuapp.com/https://openapi.etsy.com/v2/listings/active?keywords=${searchQuery}&tags=vintage&limit=200&region=GB&api_key=sh1n3isgj6bax7eotlor7m4s&includes=Images`);\n    const etsyJson = await etsyRaw.json();\n    const etsyDataResults = etsyJson.results;\n    const etsyData = etsyDataResults.map(listing => {\n      return {\n        title: listing.title,\n        price: listing.price,\n        description: listing.description,\n        image: missingImagesFiltered(listing.Images[0].url_170x135),\n        url: listing.url,\n        site: \"etsy\"\n      };\n    });\n    const trashnothingRaw = await fetch(`https://trashnothing.com/api/v1.2/posts/search?search=${searchQuery}&sort_by=relevance&types=offer&sources=trashnothing&per_page=50&page=4&device_pixel_ratio=1&latitude=51.507351&longitude=-0.127758&radius=200000&api_key=yr8sVaHEvbdkdunSFfPoDpqlwEjxIuqB3XhyFzx1`);\n    const tnJson = await trashnothingRaw.json();\n    const tnResults = tnJson.posts;\n    const trashNothingData = tnResults.map(listing => {\n      return {\n        title: listing.title,\n        price: 0,\n        description: listing.content,\n        image: tnmissingImagesFiltered(listing),\n        url: listing.url,\n        site: \"trashnothing\"\n      };\n    }); //ebay//\n\n    var ebayHeaders = new Headers();\n    ebayHeaders.append(\"Authorization\", `Bearer ${this.state.AccessToken}`);\n    ebayHeaders.append(\"Content-Type\", \"application/json\");\n    ebayHeaders.append(\"X-EBAY-C-MARKETPLACE-ID\", \"EBAY_US\");\n    ebayHeaders.append(\"X-EBAY-C-ENDUSERCTX\", \"affiliateCampaignId=<ePNCampaignId>,affiliateReferenceId=<referenceId>\");\n    var ebayrequestOptions = {\n      method: 'GET',\n      headers: ebayHeaders,\n      redirect: 'follow'\n    }; //let searchQuery = document.getElementById(\"\").value\n\n    const ebayresponse = await fetch(`https://loma-cors.herokuapp.com/https://api.ebay.com/buy/browse/v1/item_summary/search?q=${searchQuery}&limit=200&filter=conditions:{UNSPECIFIED|USED},itemLocationCountry:GB&fieldgroups=EXTENDED`, ebayrequestOptions);\n    const jsonresponse = await ebayresponse.json();\n\n    const ebayDataParsed = () => {\n      if (jsonresponse.itemSummaries) {\n        return jsonresponse.itemSummaries.map(listing => {\n          return {\n            title: isNull(listing.title),\n            description: isNull(listing.shortDescription),\n            price: isNull(ebayPriceParsed(listing)),\n            image: eBayMissingImagesFiltered(listing),\n            url: isNull(listing.itemWebUrl),\n            site: \"ebay\"\n          };\n        });\n      } else {\n        return [];\n      }\n    };\n\n    const finalData = [];\n    finalData.push(...depopDataParsed, ...gumtreeDataParsed, ...etsyData, ...ebayDataParsed(), ...trashNothingData, ...facebookDataParsed);\n\n    function highest(a, b) {\n      if (Number(a.price) < Number(b.price)) {\n        return 1;\n      }\n\n      if (Number(a.price) > Number(b.price)) {\n        return -1;\n      }\n\n      return 0;\n    }\n\n    function lowest(a, b) {\n      if (Number(a.price) < Number(b.price)) {\n        return -1;\n      }\n\n      if (Number(a.price) > Number(b.price)) {\n        return 1;\n      }\n\n      return 0;\n    }\n\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        var temp = array[i];\n        array[i] = array[j];\n        array[j] = temp;\n      }\n\n      return array;\n    }\n\n    this.state.resultsDisplay === \"âš¡ï¸ Trending âš¡ï¸\" ? this.setState({\n      Data: shuffleArray(finalData),\n      loading: false\n    }) : this.state.resultsDisplay === \"Highest price first â–²\" ? this.setState({\n      Data: finalData.sort(highest),\n      loading: false\n    }) : this.state.resultsDisplay === \"Lowest price first â–¼\" ? this.setState({\n      Data: finalData.sort(lowest)\n    }) : this.setState({\n      Data: finalData\n    });\n  }\n\n  handleChange(searchQuery) {\n    this.setState({\n      searchTerm: searchQuery\n    });\n    this.setData(searchQuery);\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App w-screen h-full bg-white\",\n      children: [/*#__PURE__*/_jsxDEV(SearchBar, {\n        onChange: this.handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 11\n      }, this), this.state.landing ? /*#__PURE__*/_jsxDEV(Landing, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 555,\n        columnNumber: 33\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 555,\n        columnNumber: 47\n      }, this), this.state.loading ? /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 556,\n        columnNumber: 33\n      }, this) : /*#__PURE__*/_jsxDEV(Results, {\n        Data: this.state.Data,\n        resultsDisplay: this.state.resultsDisplay,\n        toggleResults: this.toggleDisplay,\n        searchTerm: this.state.searchTerm,\n        search: this.handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 556,\n        columnNumber: 43\n      }, this), this.state.loading ? /*#__PURE__*/_jsxDEV(LoadingPop, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 563,\n        columnNumber: 33\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 563,\n        columnNumber: 50\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 553,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/joseph/Documents/CodingProjects/Loma V2/lomav2/src/App.js"],"names":["React","SearchBar","Results","Landing","LoadingPop","fetch","imagePlaceholder","hotjar","App","Component","constructor","props","state","Data","AccessToken","ExpiryDate","resultsDisplay","searchTerm","loading","landing","depopData","data","nothing","status","gumtreeData","handleChange","bind","setData","toggleDisplay","reOrderDisplay","componentDidMount","getEbayAccessToken","Date","getTime","console","log","myHeaders","Headers","append","urlencoded","URLSearchParams","requestOptions","method","headers","body","redirect","then","response","json","jsonresponse","setState","access_token","expires_in","catch","error","isNull","property","undefined","isPriceNull","price","substring","missingImagesFiltered","imageProp","getDepopData","depop_url","depopResponse","depopDataFiltered","filter","listing","title","toLowerCase","includes","description","depopDataParsed","map","image","url","site","getGumtreeData","gumtree_url","gumtreeResponse","gumtreeDataFiltered","gumtreeDataParsed","initialize","toggleLanding","sortOrder","shuffleArray","array","i","length","j","Math","floor","random","temp","highest","a","b","Number","lowest","sort","searchQuery","alert","ebayPriceParsed","currency","convertedFromValue","value","facebookPriceParsed","rawPrice","indexOf","tnmissingImagesFiltered","photos","eBayMissingImagesFiltered","hasOwnProperty","imageUrl","facebook_url","facebookResponse","facebookData","facebookDataFiltered","facebookDataParsed","etsyRaw","etsyJson","etsyDataResults","results","etsyData","Images","url_170x135","trashnothingRaw","tnJson","tnResults","posts","trashNothingData","content","ebayHeaders","ebayrequestOptions","ebayresponse","ebayDataParsed","itemSummaries","shortDescription","itemWebUrl","finalData","push","render"],"mappings":"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","sourcesContent":["import React from 'react';\n//import './App.css';\nimport { SearchBar } from './Components/SearchBar';\nimport { Results } from './Components/Results';\nimport { Landing } from './Components/Landing';\nimport { LoadingPop } from './Components/LoadingPop';\n\n//import { Data } from '../src/util/Data';\nimport fetch from 'node-fetch';\nimport imagePlaceholder from './assets/gallery.png';\n//import loading from './assets/loading.gif';\n\n\nimport { hotjar } from 'react-hotjar';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      Data: [],\n      AccessToken: \"none\",\n      ExpiryDate: 0,\n      resultsDisplay: \"âš¡ï¸ Trending âš¡ï¸\",\n      searchTerm: \"\",\n      loading: false,\n      landing: true,\n      depopData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      },\n      gumtreeData: {\n        data: [{nothing : \"none\"}],\n        status: 'unresolved'\n      }\n    }\n    this.handleChange = this.handleChange.bind(this);\n    this.setData = this.setData.bind(this);\n    this.toggleDisplay = this.toggleDisplay.bind(this);\n    this.reOrderDisplay = this.reOrderDisplay.bind(this);\n  }\n\n  componentDidMount() {\n\n    const getEbayAccessToken = () => {\n    if (new Date().getTime() > this.state.ExpiryDate) {\n      console.log(\"this app does not have an access token\")\n      console.log(\"getting access token\")\n\n      var myHeaders = new Headers();\n      myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n      myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n      myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n      \n      var urlencoded = new URLSearchParams();\n      urlencoded.append(\"grant_type\", \"client_credentials\");\n      urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n      \n      var requestOptions = {\n        method: 'POST',\n        headers: myHeaders,\n        body: urlencoded,\n        redirect: 'follow'\n      };\n      \n      fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions)\n          .then(response => response.json())\n          .then(jsonresponse => {\n            this.setState({\n              AccessToken: jsonresponse.access_token,\n              ExpiryDate: new Date().getTime() + jsonresponse.expires_in\n            })\n          })\n          .catch(error => console.log('error', error));\n        } \n    }\n\n\n    //DATA CLEANERS\n    const isNull = (property) => {\n      if (property === null || property === undefined) {\n     return \" \";\n     } else {\n       return property;\n     }\n     };\n\n     const isPriceNull = (price) => {\n      if (price === undefined || price === null) {\n        return \"~\";\n      } else {\n        return price.substring(1)\n      }\n    };\n\n    const missingImagesFiltered = (imageProp) => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    }\n    //\n\n    const getDepopData = async () => {\n      console.log(\"getting depop data\")\n    \n    const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n    const depopResponse = await fetch(depop_url);\n    const depopData = await depopResponse.json();\n    const depopDataFiltered = depopData.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n\n    const depopDataParsed = depopDataFiltered.map(\n      (listing) => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        }\n      }\n    );\n\n    this.setState({\n      depopData : {\n        data: depopDataParsed,\n        status: 'resolved'\n      }\n    })\n\n    }\n\n///\n\n    const getGumtreeData = async () => {\n      console.log(\"getting depop data\")\n    \n      const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\"\n      const gumtreeResponse = await fetch(gumtree_url);\n      const gumtreeData = await gumtreeResponse.json();\n      const gumtreeDataFiltered = gumtreeData.filter( listing =>\n        listing.title.toLowerCase().includes(this.state.searchTerm) || listing.description.toLowerCase().includes(this.state.searchTerm));\n  \n      const gumtreeDataParsed = gumtreeDataFiltered.map(\n        listing => {\n          return {\n            title: listing.title,\n            price: listing.price.substring(1),\n            description: listing.description,\n            image: missingImagesFiltered(listing.image),\n            url: listing.url,\n            site: \"gumtree\"\n          }\n        }\n      )\n\n    this.setState({\n      gumtreeData : {\n        data: gumtreeDataParsed,\n        status: 'resolved'\n      }\n    })\n\n    }\n\n\n    ///////\n    getEbayAccessToken();\n    getDepopData();\n    getGumtreeData();\n    hotjar.initialize(2123002,6);\n    console.log(\"access token\" +  this.state.AccessToken);\n    console.log(\"depop data\" + this.state.depopData.data);\n    \n  } //COMPONENT MOUNT ENDS\n\n  toggleLanding() {\n    this.setState({\n      landing: true,\n    }) \n  }\n\n  async toggleDisplay(sortOrder) {\n    await this.setState({ resultsDisplay: sortOrder});\n    console.log(sortOrder)\n    console.log(\"the display mode is now\" + this.state.resultsDisplay);\n    this.reOrderDisplay();\n  }\n\n  reOrderDisplay() {\n    /// functions\n\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n          var j = Math.floor(Math.random() * (i + 1));\n          var temp = array[i];\n          array[i] = array[j];\n          array[j] = temp;\n      }\n      return array;\n  }\n\n  function highest( a, b ) {\n    if ( Number(a.price) < Number(b.price) ){\n      return 1;\n    }\n    if ( Number(a.price) > Number(b.price) ){\n      return -1;\n    }\n    return 0;\n  }\n\n  function lowest( a, b ) {\n    if ( Number(a.price) < Number(b.price) ){\n      return -1;\n    }\n    if ( Number(a.price) > Number(b.price) ){\n      return 1;\n    }\n    return 0;\n  } \n\n\n  if (this.state.Data) {\n      if (this.state.resultsDisplay === \"âš¡ï¸ Trending âš¡ï¸\") {\n        this.setState({Data: shuffleArray(this.state.Data)})\n      } else if (this.state.resultsDisplay === \"Highest price first â–²\") {\n        this.setState({Data: this.state.Data.sort(highest)})\n      } else if (this.state.resultsDisplay === \"Lowest price first â–¼\") {\n        this.setState({Data: this.state.Data.sort(lowest)}) }\n        else {\n          this.setState({})}\n        }\n  }\n\n  async setData(searchQuery) {\n    if (!searchQuery) {\n      alert(\"Tell me what to search! ðŸ˜\");\n      return;\n    }\n    this.setState({searchTerm: searchQuery.toLowerCase(), loading: true, landing: false});\n    \n    if (new Date().getTime() > this.state.ExpiryDate) {\n      console.log(\"this app does not have an access token\")\n      console.log(\"getting access token\")\n\n      var myHeaders = new Headers();\n      myHeaders.append(\"Authorization\", \"Basic Sm9zZXBoVW4tTG9tYS1QUkQtMTk5YWQwZDkwLWY0Y2QyYjg4OlBSRC05OWFkMGQ5MDRiYjEtZjYzMS00OGMyLTkwNTQtYTQ5Yg==\");\n      myHeaders.append(\"Content-Type\", \"application/x-www-form-urlencoded\");\n      myHeaders.append(\"Cookie\", \"ebay=%5Esbf%3D%23%5E; dp1=bu1p/QEBfX0BAX19AQA**6379634c^\");\n      \n      var urlencoded = new URLSearchParams();\n      urlencoded.append(\"grant_type\", \"client_credentials\");\n      urlencoded.append(\"scope\", \"https://api.ebay.com/oauth/api_scope\");\n      \n      var requestOptions = {\n        method: 'POST',\n        headers: myHeaders,\n        body: urlencoded,\n        redirect: 'follow'\n      };\n      \n      fetch(\"https://loma-cors.herokuapp.com/https://api.ebay.com/identity/v1/oauth2/token\", requestOptions)\n          .then(response => response.json())\n          .then(jsonresponse => {\n            this.setState({\n              AccessToken: jsonresponse.access_token,\n              ExpiryDate: new Date().getTime() + jsonresponse.expires_in\n            })\n          })\n          .catch(error => console.log('error', error));\n    } else {\n      console.log(\"this has an access token\" + this.state.AccessToken + this.state.depopData.data);\n    }\n\n    // console.log(\"access token\" + this.state.AccessToken);\n   // let formattedExpiryDate = this.state.ExpiryDate * 1000;\n    //console.log(formattedExpiryDate.toUTCString())\n\n\n\n    /////////////////////DATA CLEANERS///////////////////////////\n    const isNull = (property) => {\n      if (property === null || property === undefined) {\n     return \" \";\n     } else {\n       return property;\n     }\n     };\n\n    //  const isAnyPropEmpty = (listing) => {\n    //    if (listing) {\n    //      return listing;\n    //    } else {\n    //      return {\n\n    //      }\n    //    } \n    //  };\n\n     const isPriceNull = (price) => {\n       if (price === undefined || price === null) {\n         return \"~\";\n       } else {\n         return price.substring(1)\n       }\n     };\n\n     const ebayPriceParsed = (listing) => {\n      if (listing.price.currency === \"USD\") {\n        return listing.price.convertedFromValue ? listing.price.convertedFromValue : listing.price.value;\n      } else {\n        return listing.price.value;\n      }\n     };\n\n     const facebookPriceParsed = (price) => {\n      let rawPrice = price.substring(1);\n      if (!price || price === \"FREE\") {\n        return \"0\"\n      } else if (price === \"See listings near me\") {\n        return \"~\"\n      } else if (!rawPrice.includes(\"Â£\")){\n        return rawPrice;\n      } else if (rawPrice.includes(\"Â£\")) {\n        return rawPrice.substring(0, rawPrice.indexOf(\"Â£\"));\n      }\n    };\n     \n    const missingImagesFiltered = (imageProp) => {\n      if (imageProp === null || imageProp === undefined) {\n        return imagePlaceholder;\n      } else {\n        return imageProp;\n      }\n    }\n\n    const tnmissingImagesFiltered = (listing) => {\n      if (!listing.photos) {\n        return imagePlaceholder\n      } else {\n        return listing.photos[0].url;\n      }\n    }\n\n    const eBayMissingImagesFiltered = (listing) => {\n      if (!listing.hasOwnProperty(\"image\") || !listing.image.hasOwnProperty(\"imageUrl\")) {\n        return imagePlaceholder;\n      } else {\n        return listing.image.imageUrl;\n      }\n    }\n     ////////////////////////////////////////////////////////////\n\n\n    \n    const depop_url = \"https://api.apify.com/v2/datasets/ml97NZifdmN1EFUSb/items?clean=true&format=json\";\n    const depopResponse = await fetch(depop_url);\n    const depopData = await depopResponse.json();\n    const depopDataFiltered = depopData.filter( (listing) => {\n      if (isNull(listing.title).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else if (isNull(listing.description).toLowerCase().includes(this.state.searchTerm)) {\n        return true;\n      } else {\n        return false;\n      }\n    })\n      // || isNull(listing.description).includes(this.state.searchTerm));\n    \n    const depopDataParsed = depopDataFiltered.map(\n      (listing) => {\n        return {\n          title: isNull(listing.title),\n          price: isPriceNull(listing.price),\n          description: isNull(listing.description),\n          image: isNull(missingImagesFiltered(listing.image)),\n          url: isNull(listing.url),\n          site: \"depop\"\n        }\n      }\n    )\n\n    const gumtree_url = \"https://api.apify.com/v2/datasets/Dh5XzAb9fvidWw285/items?format=json&clean=1\"\n    const gumtreeResponse = await fetch(gumtree_url);\n    const gumtreeData = await gumtreeResponse.json();\n    const gumtreeDataFiltered = gumtreeData.filter( listing =>\n      listing.title.toLowerCase().includes(this.state.searchTerm) || listing.description.toLowerCase().includes(this.state.searchTerm));\n\n    const gumtreeDataParsed = gumtreeDataFiltered.map(\n      listing => {\n        return {\n          title: listing.title,\n          price: listing.price.substring(1),\n          description: listing.description,\n          image: missingImagesFiltered(listing.image),\n          url: listing.url,\n          site: \"gumtree\"\n        }\n      }\n    )\n\n    const facebook_url = \"https://api.apify.com/v2/datasets/IitkxYE95yydtzFlk/items?clean=true&format=json\"\n    const facebookResponse = await fetch(facebook_url);\n    const facebookData = await facebookResponse.json();\n    const facebookDataFiltered = facebookData.filter( listing =>\n      listing.title.toLowerCase().includes(searchQuery || listing.description.toLowerCase().includes(searchQuery)));\n\n    const facebookDataParsed = facebookDataFiltered.map(\n      listing => {\n        return {\n          title: \"\" + isNull(listing.title),\n          price: \"\" + facebookPriceParsed(listing.price),\n          description: \"\" + isNull(listing.description),\n          image: \"\" + missingImagesFiltered(listing.image),\n          url: \"\" + isNull(listing.url),\n          site: \"facebook\"\n        }\n      }\n    )\n\n\n\n    ////////facebook\n    const etsyRaw = await fetch(`https://loma-cors.herokuapp.com/https://openapi.etsy.com/v2/listings/active?keywords=${searchQuery}&tags=vintage&limit=200&region=GB&api_key=sh1n3isgj6bax7eotlor7m4s&includes=Images`);\n    const etsyJson = await etsyRaw.json();\n    const etsyDataResults = etsyJson.results;\n    const etsyData = etsyDataResults.map( listing => {\n      return {\n        title: listing.title,\n        price: listing.price,\n        description: listing.description,\n        image: missingImagesFiltered(listing.Images[0].url_170x135),\n        url: listing.url,\n        site: \"etsy\"\n      }\n    });\n\n    const trashnothingRaw = await fetch(`https://trashnothing.com/api/v1.2/posts/search?search=${searchQuery}&sort_by=relevance&types=offer&sources=trashnothing&per_page=50&page=4&device_pixel_ratio=1&latitude=51.507351&longitude=-0.127758&radius=200000&api_key=yr8sVaHEvbdkdunSFfPoDpqlwEjxIuqB3XhyFzx1`);\n    const tnJson = await trashnothingRaw.json();\n    const tnResults = tnJson.posts;\n    const trashNothingData = tnResults.map( listing => {\n      return {\n        title: listing.title,\n        price: 0,\n        description: listing.content,\n        image: tnmissingImagesFiltered(listing),\n        url: listing.url,\n        site: \"trashnothing\"\n      }\n    });\n\n\n\n\n    //ebay//\n\n\n    var ebayHeaders = new Headers();\n    ebayHeaders.append(\"Authorization\", `Bearer ${this.state.AccessToken}`);\n    ebayHeaders.append(\"Content-Type\", \"application/json\");\n    ebayHeaders.append(\"X-EBAY-C-MARKETPLACE-ID\", \"EBAY_US\");\n    ebayHeaders.append(\"X-EBAY-C-ENDUSERCTX\", \"affiliateCampaignId=<ePNCampaignId>,affiliateReferenceId=<referenceId>\");\n    \n    var ebayrequestOptions = {\n      method: 'GET',\n      headers: ebayHeaders,\n      redirect: 'follow'\n    };\n    \n    //let searchQuery = document.getElementById(\"\").value\n\n    const ebayresponse = await fetch(`https://loma-cors.herokuapp.com/https://api.ebay.com/buy/browse/v1/item_summary/search?q=${searchQuery}&limit=200&filter=conditions:{UNSPECIFIED|USED},itemLocationCountry:GB&fieldgroups=EXTENDED`, ebayrequestOptions);\n    const jsonresponse = await ebayresponse.json();\n    const ebayDataParsed = () => {\n      if (jsonresponse.itemSummaries) {\n           return jsonresponse.itemSummaries.map(\n            (listing) => {\n                return {\n                    title: isNull(listing.title),\n                    description: isNull(listing.shortDescription),\n                    price: isNull(ebayPriceParsed(listing)),\n                    image: eBayMissingImagesFiltered(listing),\n                    url: isNull(listing.itemWebUrl),\n                    site: \"ebay\"\n                }\n            }\n        )\n      } else { \n        return [];\n      }\n     \n    }\n\n    const finalData = [];\n    finalData.push(...depopDataParsed,...gumtreeDataParsed,...etsyData,...ebayDataParsed(),...trashNothingData,...facebookDataParsed);\n\n    function highest( a, b ) {\n      if ( Number(a.price) < Number(b.price) ){\n        return 1;\n      }\n      if ( Number(a.price) > Number(b.price) ){\n        return -1;\n      }\n      return 0;\n    }\n\n    function lowest( a, b ) {\n      if ( Number(a.price) < Number(b.price) ){\n        return -1;\n      }\n      if ( Number(a.price) > Number(b.price) ){\n        return 1;\n      }\n      return 0;\n    } \n\n    function shuffleArray(array) {\n      for (var i = array.length - 1; i > 0; i--) {\n          var j = Math.floor(Math.random() * (i + 1));\n          var temp = array[i];\n          array[i] = array[j];\n          array[j] = temp;\n      }\n      return array;\n  }\n\n      this.state.resultsDisplay === \"âš¡ï¸ Trending âš¡ï¸\" ? this.setState({Data: shuffleArray(finalData), loading: false})\n     : this.state.resultsDisplay === \"Highest price first â–²\" ? this.setState({Data: finalData.sort(highest), loading: false})\n     : this.state.resultsDisplay === \"Lowest price first â–¼\" ? this.setState({Data: finalData.sort(lowest)})\n     : this.setState({Data: finalData})\n\n\n  }\n\n  handleChange(searchQuery) {\n    this.setState({ searchTerm: searchQuery });\n    this.setData(searchQuery);\n\n  }\n  \n  render() {\n    return (\n      <div className=\"App w-screen h-full bg-white\">\n          <SearchBar onChange={this.handleChange}/>\n          {this.state.landing ? <Landing /> : <p></p >} \n          {this.state.loading ? <p></p> : <Results Data={this.state.Data}\n                  resultsDisplay={this.state.resultsDisplay}\n                  toggleResults={this.toggleDisplay}\n                  searchTerm={this.state.searchTerm}\n                  search={this.handleChange}\n                  />}\n         \n          {this.state.loading ? <LoadingPop /> : <p></p>}\n  \n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}